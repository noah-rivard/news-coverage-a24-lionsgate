{
  "version": 3,
  "sources": ["../src/options.ts"],
  "sourcesContent": ["const endpointInput = document.getElementById(\"endpoint\") as HTMLInputElement | null;\nconst statusEl = document.getElementById(\"status\");\nconst linksMetaEl = document.getElementById(\"links_meta\");\n\nfunction setStatus(text: string, color = \"inherit\") {\n  if (statusEl) {\n    statusEl.textContent = text;\n    (statusEl as HTMLElement).style.color = color;\n  }\n}\n\nfunction isHttpUrl(raw: string): boolean {\n  try {\n    const u = new URL(raw);\n    return u.protocol === \"http:\" || u.protocol === \"https:\";\n  } catch {\n    return false;\n  }\n}\n\nfunction deriveServerBase(endpoint: string): string | null {\n  if (!isHttpUrl(endpoint)) return null;\n  const u = new URL(endpoint);\n  const suffixes = [\"/process/articles\", \"/process/article\", \"/ingest/article\"];\n  let basePath = u.pathname;\n  for (const suffix of suffixes) {\n    if (basePath.endsWith(suffix)) {\n      basePath = basePath.slice(0, -suffix.length);\n      break;\n    }\n  }\n  basePath = basePath.replace(/\\/+$/, \"\");\n  return u.origin + basePath;\n}\n\nfunction joinUrl(base: string, path: string): string {\n  const normalizedBase = base.endsWith(\"/\") ? base.slice(0, -1) : base;\n  const normalizedPath = path.startsWith(\"/\") ? path : `/${path}`;\n  return `${normalizedBase}${normalizedPath}`;\n}\n\nfunction openUrl(url: string) {\n  chrome.tabs.create({ url }).catch(() => undefined);\n}\n\nfunction setDisabled(id: string, disabled: boolean) {\n  const el = document.getElementById(id) as HTMLButtonElement | null;\n  if (el) el.disabled = disabled;\n}\n\nfunction bindOpen(id: string, urlProvider: () => string | null) {\n  const el = document.getElementById(id);\n  if (!el) return;\n  (el as HTMLButtonElement).onclick = () => {\n    const url = urlProvider();\n    if (url && isHttpUrl(url)) openUrl(url);\n  };\n}\n\nfunction renderLinks(endpoint: string) {\n  const serverBase = deriveServerBase(endpoint);\n  if (linksMetaEl) {\n    linksMetaEl.textContent = serverBase\n      ? `Endpoint: ${endpoint}\\nServer base: ${serverBase}`\n      : `Endpoint: ${endpoint}`;\n  }\n  setDisabled(\"open_review\", !serverBase);\n  setDisabled(\"open_health\", !serverBase);\n  setDisabled(\"open_process_articles\", !serverBase);\n  setDisabled(\"open_ingest_article\", !serverBase);\n\n  bindOpen(\"open_endpoint\", () => endpoint);\n  bindOpen(\"open_openai_logs\", () => \"https://platform.openai.com/logs?api=responses\");\n  bindOpen(\"open_review\", () => (serverBase ? joinUrl(serverBase, \"/review\") : null));\n  bindOpen(\"open_health\", () => (serverBase ? joinUrl(serverBase, \"/health\") : null));\n  bindOpen(\n    \"open_process_articles\",\n    () => (serverBase ? joinUrl(serverBase, \"/process/articles\") : null),\n  );\n  bindOpen(\n    \"open_ingest_article\",\n    () => (serverBase ? joinUrl(serverBase, \"/ingest/article\") : null),\n  );\n}\n\nasync function loadSettings() {\n  const { ingestEndpoint } = await chrome.storage.sync.get({\n    ingestEndpoint: \"http://localhost:8000/process/articles\",\n  });\n  if (endpointInput) endpointInput.value = ingestEndpoint;\n  renderLinks((ingestEndpoint || \"\").trim() || \"http://localhost:8000/process/articles\");\n}\n\nasync function saveSettings() {\n  if (!endpointInput) return;\n  const value = endpointInput.value.trim();\n  await chrome.storage.sync.set({ ingestEndpoint: value });\n  setStatus(\"Saved.\", \"green\");\n  renderLinks(value || \"http://localhost:8000/process/articles\");\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  loadSettings();\n  const saveBtn = document.getElementById(\"save\");\n  if (saveBtn) {\n    saveBtn.addEventListener(\"click\", saveSettings);\n  }\n});\n"],
  "mappings": "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",
  "names": []
}
